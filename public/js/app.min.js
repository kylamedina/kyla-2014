(function($,window){var $win=$(window);var defaults={gap:0,horizontal:false,isFixed:$.noop};$.fn.fixer=function(options){options=$.extend({},defaults,options);var hori=options.horizontal,cssPos=hori?"left":"top";return this.each(function(){var style=this.style,$this=$(this),$parent=$this.parent();$win.on("scroll",function(){var scrollPos=$win[hori?"scrollLeft":"scrollTop"](),elemSize=$this[hori?"outerWidth":"outerHeight"](),parentPos=$parent.offset()[cssPos],parentSize=$parent[hori?"outerWidth":"outerHeight"]();if(scrollPos>=parentPos-options.gap&&parentSize+parentPos-options.gap>=scrollPos+elemSize){style.position="fixed";style[cssPos]=options.gap+"px";options.isFixed()}else if(scrollPos<parentPos){style.position="absolute";style[cssPos]=0}else{style.position="absolute";style[cssPos]=parentSize-elemSize+"px"}}).resize()})}})(jQuery,this);
(function(){var backToTop,cacheArray,closeMarkers,closePanel,fixie,footer,foreverScroll,imgArray,imgFadeIn,imgload,loadNewPage,markerScroll,markers,openMarkers,openPanel,packery,pageLoaded,projectsCache,runHome,runProjects,stopMarkerScroll,wh,ww;ww=$(window).width();wh=$(window).height();$.fn.scrollStopped=function(callback){$(this).scroll(function(){var $this,self;self=this;$this=$(self);if($this.data("scrollTimeout")){clearTimeout($this.data("scrollTimeout"))}$this.data("scrollTimeout",setTimeout(callback,250,self))})};$("body").on("click","[data-page='projects']",function(e){e.preventDefault();if($("body").hasClass("ajax-projects")){return $("html,body").animate({scrollTop:$("#top").offset().top},700)}else{$("html,body").scrollTop($("#top").offset().top);loadNewPage();return $.ajax({url:"/projects",data:{order:$(this).attr("data-order")},cache:true,success:function(data){$(".view-main").html(data);$("body").removeClass("ajax-home").addClass("ajax-projects");runProjects();$(".fixie").width($(".project-desc").width());return pageLoaded()}})}});$("body").on("click","[data-page='home']",function(e){e.preventDefault();if($("body").hasClass("ajax-home")){return $("html,body").animate({scrollTop:$("#top").offset().top},700)}else{loadNewPage();return $.ajax({url:"/home",cache:true,success:function(data){$(".view-main").html(data);$("html,body").scrollTop($("#top").offset().top);$("body").removeClass("ajax-projects").addClass("ajax-home");runHome();return pageLoaded()}})}});loadNewPage=function(){return $(".view-main").addClass("is-loading")};pageLoaded=function(){return $(".view-main").removeClass("is-loading")};packery=function(){var homeGrid,pckry;homeGrid=document.querySelector(".grid");pckry=new Packery(homeGrid,{itemSelector:".grid-item",isFitWidth:true,isHorizontal:false,columnWidth:".grid-sizer",rowHeight:0,gutter:30,isInitLayout:true,isResizeBound:true,transitionDuration:"0.3s"});return pckry.layout()};foreverScroll=function(){return $(".spawn").waypoint({continuous:false,triggerOnce:true,handler:function(down){if($(".view-main").children().length>15){$.waypoints("disable");$(".clone").remove();$.waypoints("enable")}return $(".spawn").addClass("clone").removeClass("spawn").clone().appendTo(".view-main").addClass("spawn").removeClass("clone")}})};backToTop=function(){return $('a[href*="#"]').on("click",function(e){$("html,body").animate({scrollTop:$(this.hash).offset().top},700);$(".clone").remove();e.preventDefault();return false})};imgFadeIn=function(){if(head.desktop||ww>1024){return $("img").waypoint({offset:wh-wh/9,handler:function(direction){if(direction==="down"){return $(this).css("opacity",1)}}})}else{return $("img").css("opacity",1)}};fixie=function(){$(".fixie").width($(".project-desc").width());return $(".fixie").fixer({gap:118})};openPanel=function(){return $("body").on("click",".activate-panel",function(){if($("body").hasClass("panel-is-open")){return $("body").removeClass("panel-is-open")}else{return $("body").addClass("panel-is-open")}})};closePanel=function(){if($("body").hasClass("panel-is-open")){return $("body").removeClass("panel-is-open")}};footer=function(){return $(window).on("scroll",function(){if($(window).scrollTop()+$(window).height()>$(document).height()-80){return $("body").addClass("footer-is-showing")}else{return $("body").removeClass("footer-is-showing")}})};markerScroll=function(){return $(".fixie").waypoint({offset:144,handler:function(direction){var markerID;({context:".project"});markerID=$(this).data("marker").toString();$(".marker").removeClass("is-active");return $("."+markerID).addClass("is-active")}})};openMarkers=function(){return $(".ajax-projects").removeClass("markers-hidden").addClass("markers-visible")};closeMarkers=function(){return $(".ajax-projects").removeClass("markers-visible").addClass("markers-hidden")};markers=function(){return $(".project-markers, button.fixed-right").on("mouseover",function(){return openMarkers()})};stopMarkerScroll=function(){return $(window).scrollStopped(function(){closeMarkers()})};$(window).on("scroll",function(){$(".fixie").width($(".project-desc").width());if(head.desktop&&ww>640){foreverScroll();openMarkers()}if($(window).scrollTop()>50){$(".header-main h1").removeClass("at-top").addClass("scrolling")}else{$(".header-main h1").removeClass("scrolling").addClass("at-top")}if($(window).scrollTop()>150){$(".back-top-container").css("opacity","1")}else{$(".back-top-container").css("opacity","0")}});$(window).on("resize",function(){$(".fixie").width($(".project-desc").width());if(ww<641){return footer()}});cacheArray=function(){var i,img,url,_results;i=0;_results=[];while(i<imgArray.length){url=imgArray[i];img=new Image;img.src=url;_results.push(i++)}return _results};projectsCache=function(){return cacheArray()};imgArray=["img/projects/artnet_01.small.min.png","img/projects/artnet_02.small.min.png","img/projects/clear_01.small.min.png","img/projects/ihny_01.small.min.png","img/projects/ihny_02.small.min.png","img/projects/ihny_03.small.min.png","img/projects/rms_01.small.min.png","img/projects/rms_02.small.min.png","img/projects/rms_03.small.min.png","img/projects/sa_01.small.min.png","img/projects/sa_02.small.min.png","img/projects/sa_03.small.min.png","img/projects/sa_04.small.min.png","img/projects/sa_05.small.min.png","img/projects/vse_01.small.min.png","img/projects/vse_02.small.min.png"];imgload=function(){return $(".project-img").waitForImages(function(){$(".loading",this).remove();$("img").css("opacity",1)})};runHome=function(){packery();backToTop()};runProjects=function(){backToTop();fixie();closePanel();footer();markers();markerScroll();stopMarkerScroll();imgload()};$(document).ready(function(){$(".clone").remove();return $("h1").addClass("at-top")});$(window).on("load",function(){runHome();openPanel();pageLoaded();projectsCache();if(ww<641){return footer()}})}).call(this);